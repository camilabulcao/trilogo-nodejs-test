<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Chat Trilogo</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src= "https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.1.1/socket.io.js"></script>

    <link rel="stylesheet" href="styles.css">

</head>
<body>
    <img src="data:image/png;base64,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">
    <form id="chat">
        <input id="text" name="ticket_id" placeholder="ticket_id">
        <input id="text" name="permalink" placeholder="Permalink">
        <input id="text" name="username" placeholder="Digite seu usuÃ¡rio">
        <div class="messages"></div>
        <input id="text" name="message" placeholder="Digite sua mensagem">
        <button type="submit">Enviar</button>
    </form>
    <script type="text/javascript">
    var socket = io('http://localhost:3000')
    

    function renderMessage(message) { //Para renderizar a msg na tela
        $('.messages').append('<div class="message"><strong>'+message.autor +'</strong>: '+ message.texto +'</div>')
    }

        socket.on('previousMessages',function(messages){
            for(message of messages){
                renderMessage(message)
            }
        })

        socket.on('receivedMessage', function(message) {
            renderMessage(message)
        })

    $('#chat').submit(function(event){
        event.preventDefault()

        var ticket_id= $('input[name=ticket_id]').val()
        var permalink = $('input[name=permalink]').val()
        var author = $('input[name=username]').val()
        var message = $('input[name=message]').val()
        
        if(author.length && message.length && permalink.length && ticket_id.length) {
            var messageObject ={
                autor: author,
                texto: message,
                sala: ticket_id,
            };

            renderMessage(messageObject)
            socket.emit('sendMessage', messageObject)
        }
   
    })

    </script>
</body>
</html>